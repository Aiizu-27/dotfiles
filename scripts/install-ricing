#!/bin/bash

########################################
# Script completo de ricing para Arch
# Rofi Â· Alacritty Â· Picom Â· Polybar
# Zsh Â· Oh My Zsh Â· Plugins Â· Ranger Â· Feh
########################################

set -e

# Ruta de Oh My Zsh
ZSH_CUSTOM=${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}

echo "ğŸš€ Iniciando instalaciÃ³n de entorno de ricing..."

# --------------------------------------------------
# Actualizar sistema
# --------------------------------------------------
echo "ğŸ”„ Actualizando sistema..."
sudo pacman -Syu --noconfirm

# --------------------------------------------------
# Instalar paquetes base
# --------------------------------------------------
echo "âœ¨ Instalando paquetes..."
sudo pacman -S --noconfirm --needed \
    rofi \
    alacritty \
    picom \
    polybar \
    zsh \
    ranger \
    feh \
    git \
    curl

# --------------------------------------------------
# Instalar Oh My Zsh
# --------------------------------------------------
echo "ğŸš Instalando Oh My Zsh..."
if [ ! -d "$HOME/.oh-my-zsh" ]; then
    RUNZSH=no CHSH=no sh -c \
    "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
else
    echo "â„¹ï¸  Oh My Zsh ya estÃ¡ instalado."
fi

# --------------------------------------------------
# Plugins de Zsh
# --------------------------------------------------
echo "ğŸ”Œ Instalando plugins de Zsh..."

# zsh-autosuggestions
if [ ! -d "$ZSH_CUSTOM/plugins/zsh-autosuggestions" ]; then
    echo "ğŸ“¦ Instalando zsh-autosuggestions..."
    git clone https://github.com/zsh-users/zsh-autosuggestions \
        "$ZSH_CUSTOM/plugins/zsh-autosuggestions"
else
    echo "âœ… zsh-autosuggestions ya estÃ¡ instalado."
fi

# zsh-syntax-highlighting
if [ ! -d "$ZSH_CUSTOM/plugins/zsh-syntax-highlighting" ]; then
    echo "ğŸ“¦ Instalando zsh-syntax-highlighting..."
    git clone https://github.com/zsh-users/zsh-syntax-highlighting.git \
        "$ZSH_CUSTOM/plugins/zsh-syntax-highlighting"
else
    echo "âœ… zsh-syntax-highlighting ya estÃ¡ instalado."
fi

# --------------------------------------------------
# Final
# --------------------------------------------------
echo ""
echo "ğŸ‰ InstalaciÃ³n completada con Ã©xito."
echo "ğŸ” Reinicia la terminal o ejecuta: source ~/.zshrc"